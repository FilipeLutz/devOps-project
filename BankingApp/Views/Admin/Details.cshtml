<!--jon gouspy 74538-->
@model BankingApp.Models.User

@{
    Layout = null;
    if (Session["Id"] == null)
    {
        Response.Redirect("~/Login/Index");
    }
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Details</title>
    <link href="@Url.Content("~/Content/global.css")" rel="stylesheet" type="text/css" />

    <style>
        .account-details {
            margin-bottom: 20px;
        }

        .dl-horizontal dt {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .dl-horizontal dd {
            margin-left: 0;
            margin-bottom: 30px;
        }

        #accountTable tr.active {
            background-color: #C5EBAA;
        }

        #logout-btn {
            position: fixed;
            bottom: 20px;
            left: 30px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="buttons-section">
            <h1>ADMIN</h1>
            @Html.ActionLink("Transactions", "Index", "Transactions", new { id = "__id__" }, new { @class = "transaction accountInfo disabled", @id = "transactionBtn" })
            @Html.ActionLink("New Transaction", "Create", "Transactions", new { id = "__id__" }, new { @class = "newtransaction accountInfo disabled", @id = "newtransactionBtn" })
            @Html.ActionLink("Back to Users", "Index")
            @Html.ActionLink("Log Out", "LogOut", "Login", null, new { @id = "logout-btn" })
        </div>
        <div class="text-section">
            <h3>User</h3>
            <hr />
            <div class="account-details">
                <dl class="dl-horizontal">
                    <dt>@Html.DisplayNameFor(model => model.FirstName)</dt>
                    <dd>@Html.DisplayFor(model => model.FirstName)</dd>

                    <dt>@Html.DisplayNameFor(model => model.LastName)</dt>
                    <dd>@Html.DisplayFor(model => model.LastName)</dd>

                    <dt>@Html.DisplayNameFor(model => model.Email)</dt>
                    <dd>@Html.DisplayFor(model => model.Email)</dd>

                    <dt>@Html.DisplayNameFor(model => model.AccountNumber)</dt>
                    <dd>@Html.DisplayFor(model => model.AccountNumber)</dd>

                    <dt>@Html.DisplayNameFor(model => model.AccountNumber)</dt>
                </dl>
                <hr />
                <table class="table" id="accountTable">
                    <tr>
                        <th>Id</th>
                        <th>Account Type</th>
                        <th>Balance</th>
                    </tr>

                    @foreach (var item in Model.Accounts)
                    {
                        <tr data-account-id="@item.Id">
                            <td>
                                @Html.DisplayFor(modelItem => item.Id)
                            </td>
                            <td>
                                @if (item.AccountType == 0)
                                {
                                    @:Current Account
                                }
                                else
                                {
                                    @:Saving Account
                                }
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Balance) €
                            </td>
                        </tr>
                    }
                </table>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#accountTable tr').click(function () {
                // Supprimer la classe "active" de toutes les lignes
                $('#accountTable tr').removeClass('active');

                // Ajouter la classe "active" à la ligne cliquée
                $(this).addClass('active');

                // Supprimer la classe "disabled" des liens lorsqu'une ligne du tableau est cliquée
                $('.transaction, .newtransaction').removeClass('disabled');

                // Récupérer l'ID du compte associé à la ligne du tableau
                var accountId = $(this).data('account-id');

                // Mettre à jour les liens avec l'ID du compte
                $('#transactionBtn').attr('href', '@Url.Action("Index", "Transactions")' + '?id=' + accountId);
                $('#newtransactionBtn').attr('href', '@Url.Action("Create", "Transactions")' + '?id=' + accountId);
                });
        });
    </script>
    <script src="~/Scripts/logout-btn.js"></script>
</body>
</html>
